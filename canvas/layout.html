<html>
<body>
	<div id="container"></div>
	<script type="text/javascript" src="kinetic-v4.2.0.js"></script>
	<script type="text/javascript" src="kinetic.bezier.js"></script>
	<script type="text/javascript" src="kinetic.connector.js"></script>
	<script type="text/javascript" src="kinetic.idea.js"></script>
	<script type="text/javascript" src="../src/observable.js"></script>
	<script type="text/javascript" src="../src/content.js"></script>
	<script type="text/javascript" src="../src/layout.js"></script>
	<script type="text/javascript" src="../lib/underscore-1.4.3-min.js"></script>
	<script>
		var stage = new Kinetic.Stage({
			container: 'container',
			width: 1000,
			height: 1000
		});
		var layer = new Kinetic.Layer();
		var idea = content({
				id: 7,
				title: '1',
				ideas: {
					1: {
						id: 8,
						title: '11',
						ideas: {
							1: {
								id: 10,
								title: '111'
							},
							2: {
								id: 11,
								title: '112'
							},
							3: {
								id: 12,
								title: '113'
							}
						}
					},
					3: {
						id: 9,
						title: '12'
					},
				}
			});
		var dp = function (title) {
			var text = new Kinetic.Idea({
				text: title
			});
			return {
				width: text.getWidth(),
				height: text.getHeight()
			};
		};
		MAPJS.tmpDraw = function (layer, idea) {
			var layout = MAPJS.calculateLayout2(idea, dp),
				ideaId,
				nodePosition,
				text,
				nodes = {},
				i,
				connector;
			for (ideaId in layout.nodes) {
				nodePosition = layout.nodes[ideaId];
				nodes[ideaId] = new Kinetic.Idea({
					x: nodePosition.x,
					y: nodePosition.y,
					text: nodePosition.title
				});
				layer.add(nodes[ideaId]);
			};
			for (i = 0; i < layout.connectors.length; i++) {
				connector = layout.connectors[i];
				layer.add(new Kinetic.Connector({
					shapeFrom: nodes[connector.from],
					shapeTo: nodes[connector.to],
					stroke: '#888',
					strokeWidth: 2
				}));
			}
		};
		MAPJS.tmpDraw(layer, idea);
		stage.add(layer);
	</script>
</body>
</html>
